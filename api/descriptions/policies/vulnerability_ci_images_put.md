Simultaneously updates all vulnerability rules to raise alerts or block deployments when images with vulnerabilities are detected.

This policy targets a your Corporate Identify (CI) pipeline. The policy set in this endpoint targets the scanners in the Jenkins plugin and the `twistcli` command line tool.

**Notes:**

* If your CI is built on Jenkins, a native Jenkins plugin is available.
* If your CI is built on a platform where a native plugin is unavailable (CircleCI, AWS CodeBuild, etc), you can use the `twistcli` command line tool.

### cURL Request

The following cURL command replaces the vulnerability rules for `<USER>`.

```bash
$ curl 'https://<CONSOLE>/api/v1/policies/vulnerability/ci/images?project=<PROJECT>' \
  -X PUT \
  -u <USER> \
  -H 'Content-Type: application/json' \
  -d \
'{
  "rules": [
    {
      "effect": "alert",
      "action": [
        "*"
      ],
      "condition": {
        "vulnerabilities": []
      },
      "blockMsg": "",
      "principal": [],
      "group": [
        "*"
      ],
      "verbose": false,
      "allCompliance": false,
      "onlyFixed": false,
      "cveRules": [],
      "tags": [],
      "alertThreshold": {
        "value": 1,
        "disabled": false
      },
      "blockThreshold": {
        "value": 0,
        "enabled": false
      },
      "collections": [
        {
          "hosts": [
            "*"
          ],
          "images": [
            "*"
          ],
          "labels": [
            "*"
          ],
          "containers": [
            "*"
          ],
          "functions": [
            "*"
          ],
          "namespaces": [
            "*"
          ],
          "appIDs": [
            "*"
          ],
          "accountIDs": [
            "*"
          ],
          "codeRepos": [
            "*"
          ],
          "clusters": [
            "*"
          ],
          "name": "All",
          "owner": "system",
          "modified": "2020-12-18T19:19:56.493Z",
          "color": "#3FA2F7",
          "description": "System - all resources collection",
          "system": true
        }
      ],
      "name": "<RULE_NAME>",
      "notes": "<NOTE>",
      "owner": "<OWNER>",
      "modified": "2020-12-18T19:41:33.567Z"
    },
    {
      "modified": "2020-12-18T19:19:55.185Z",
      "owner": "system",
      "name": "Default - alert all components",
      "previousName": "",
      "effect": "alert",
      "collections": [
        {
          "hosts": [
            "*"
          ],
          "images": [
            "*"
          ],
          "labels": [
            "*"
          ],
          "containers": [
            "*"
          ],
          "functions": [
            "*"
          ],
          "namespaces": [
            "*"
          ],
          "appIDs": [
            "*"
          ],
          "accountIDs": [
            "*"
          ],
          "codeRepos": [
            "*"
          ],
          "clusters": [
            "*"
          ],
          "name": "All",
          "owner": "system",
          "modified": "2020-12-18T19:19:55.944Z",
          "color": "#3FA2F7",
          "description": "System - all resources collection",
          "system": true
        }
      ],
      "condition": {
        "readonly": false,
        "device": "",
        "vulnerabilities": []
      },
      "alertThreshold": {
        "disabled": false,
        "value": 0
      },
      "blockThreshold": {
        "enabled": false,
        "value": 0
      },
      "graceDays": 0
    }
  ],
  "policyType": "ciImagesVulnerability",
  "_id": "ciImagesVulnerability",
  "type": "vulnerability",
  "policyContext": "ciImages"
}'
``

**Note:** No response will be returned upon successful execution.
