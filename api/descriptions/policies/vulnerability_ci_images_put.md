Adds a vulnerability rule to raise alerts or block deployments when images with vulnerabilities are detected.

This policy targets a your Corporate Identify (CI) pipeline. The policy set in this endpoint targets the scanners in the Jenkins plugin and the `twistcli` command line tool.

**Notes:**

* If your CI is built on Jenkins, a native Jenkins plugin is available.
* If your CI is built on a platform where a native plugin is unavailable (CircleCI, AWS CodeBuild, etc), you can use the `twistcli` command line tool.

### cURL Request

The following cURL command creates a vulnerability rule for `<USER>` with the rule name `<RULE_NAME>`.

```bash
$ curl -k \
  -u <USER> \
  -H 'Content-Type: application/json' \
  -X PUT \
  -d \
'{
   "rules":[
      {
         "effect":"alert",
         "action":[
            "*"
         ],
         "condition":{
            "vulnerabilities":[
               
            ]
         },
         "blockMsg":"",
         "principal":[
            
         ],
         "group":[
            "*"
         ],
         "namespace":[
            "*"
         ],
         "verbose":false,
         "resources":{
            "images":[
               "*"
            ],
            "labels":[
               "*"
            ]
         },
         "allCompliance":false,
         "onlyFixed":false,
         "cveRules":[
            
         ],
         "tags":[
            
         ],
         "alertThreshold":{
            "value":1,
            "disabled":false
         },
         "blockThreshold":{
            "value":0,
            "enabled":false
         },
         "name":"<RULE_NAME>",
         "modified":"2020-12-02T02:06:59.733Z",
         "owner":"<USER>"
      },
      {
         "modified":"2020-11-12T22:22:28.664Z",
         "owner":"system",
         "name":"Default - alert all components",
         "previousName":"",
         "effect":"alert",
         "resources":{
            "hosts":[
               "*"
            ],
            "images":[
               "*"
            ],
            "labels":[
               "*"
            ],
            "containers":[
               "*"
            ],
            "namespaces":[
               "*"
            ],
            "accountIDs":[
               "*"
            ],
            "clusters":[
               "*"
            ]
         },
         "condition":{
            "readonly":false,
            "device":"",
            "vulnerabilities":[
               
            ]
         },
         "alertThreshold":{
            "disabled":false,
            "value":0
         },
         "blockThreshold":{
            "enabled":false,
            "value":0
         },
         "graceDays":0
      }
   ],
   "policyType":"ciImagesVulnerability",
   "_id":"ciImagesVulnerability",
   "type":"vulnerability",
   "policyContext":"ciImages"
}' \
  https://<CONSOLE>/api/v1/policies/vulnerability/ci/images
``

**Note:** No response will be returned upon successful execution.
